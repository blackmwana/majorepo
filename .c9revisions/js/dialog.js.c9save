{"ts":1361743548258,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"/*  Author: Valerio Battaglia (vabatta)\n *  Description: Function to create dialog box. You can have a dialog box open at once.\n *  Version: 1.0a\n *\n *  Params:\n *      title - Title of the dialog box (HTML format)\n *      content - Content of the dialog box (HTML format)\n *      draggable - Set draggable to dialog box, available: true, false (default: false)\n *      overlay - Set the overlay of the page, available: true, false (default: true)\n *      closeButton - Enable or disable the close button, available: true, false (default: false)\n *      buttonsAlign - Align of the buttons, available: left, center, right (default: center)\n *      buttons - Set buttons in the action bar (JSON format)\n *          name - Text of the button (JSON format)\n *              action - Function to bind to the button\n *      position - Set the initial position of the dialog box (JSON format)\n *          zone - Zone of the dialog box, available: left, center, right (default: center)\n *          offsetY - Top offset pixels\n *          offsetX - Left offset pixels\n *      \n *   Goal for next versions:\n *      Add style param to set custom css to the dialog box controls\n *      Add possibility to resize window\n */\n\n(function($) {\n    $.Dialog = function(params) {\n        if(!$.DialogOpened) {\n            $.DialogOpened = true;\n        } else {\n            return false;\n        }\n\n        params = $.extend({'position':{'zone':'center'},'overlay':true}, params);\n\n        var buttonsHTML = '<div';\n\n        // Buttons position\n        if(params.buttonsAlign)\n        {\n            buttonsHTML += ' style=\" float: ' + params.buttonsAlign + ';\">';\n        } else {\n            buttonsHTML += '>';\n        }\n\n        $.each(params.buttons, function(name,obj) {\n            // Generating the markup for the buttons\n\n            buttonsHTML += '<button>' + name + '</button>';\n            \n            if(!obj.action) \n            {\n                obj.action = function() {};\n            }\n        });\n\n        buttonsHTML += '</div>';\n\n        var markup = [\n            // If overlay is true, set it\n\n            '<div id=\"dialogOverlay\">',\n            '<div id=\"dialogBox\" class=\"dialog\">',\n            '<div class=\"header\">',\n            params.title,\n            (params.closeButton)?('<div><button><i class=\"icon-cancel-2\"></i></button></div>'):(''),\n            '</div>',\n            '<div class=\"content\">', params.content, '</div>',\n            '<div class=\"action\" id=\"dialogButtons\">',\n            buttonsHTML,\n            '</div></div></div>'\n        ].join('');\n\n        $(markup).hide().appendTo('body').fadeIn();\n\n        if(!params.overlay) {\n            $('#dialogOverlay').css('background-color', 'rgba(255, 255, 255, 0)');\n        }\n        \n        // Setting initial position\n        if(params.position.zone == \"left\")\n        {\n            $('#dialogBox').css(\"top\", Math.max(0, (($(window).height() - $('#dialogBox').outerHeight()) / 3) + \n                                                $(window).scrollTop()) + \"px\");\n            $('#dialogBox').css(\"left\", 0);\n        } \n        else if(params.position.zone == \"right\")\n        {\n            $('#dialogBox').css(\"top\", Math.max(0, (($(window).height() - $('#dialogBox').outerHeight()) / 3) + \n                                                $(window).scrollTop()) + \"px\");\n            $('#dialogBox').css(\"left\", Math.max(0, (($(window).width() - $('#dialogBox').outerWidth())) + \n                                                            $(window).scrollLeft()) + \"px\");\n        } \n        else\n        {\n            $('#dialogBox').css(\"top\", (params.position.offsetY)?(params.position.offsetY):(Math.max(0, (($(window).height() - $('#dialogBox').outerHeight()) / 3) + \n                                                                                                $(window).scrollTop()) + \"px\"));\n            $('#dialogBox').css(\"left\", (params.position.offsetX)?(params.position.offsetX):(Math.max(0, (($(window).width() - $('#dialogBox').outerWidth()) / 2) + \n                                                                                                $(window).scrollLeft()) + \"px\"));\n        }\n\n        if(params.draggable) {\n            // Make draggable the window\n\n            $('#dialogBox div.header').css('cursor', 'move').on(\"mousedown\", function(e) {\n                var $drag = $(this).addClass('active-handle').parent().addClass('draggable');\n\n                var z_idx = $drag.css('z-index'),\n                    drg_h = $drag.outerHeight(),\n                    drg_w = $drag.outerWidth(),\n                    pos_y = $drag.offset().top + drg_h - e.pageY,\n                    pos_x = $drag.offset().left + drg_w - e.pageX;\n                $drag.css('z-index', 99999).parents().on(\"mousemove\", function(e) {\n                    $('.draggable').offset({\n                        top:e.pageY + pos_y - drg_h,\n                        left:e.pageX + pos_x - drg_w\n                    }).on(\"mouseup\", function() {\n                        $(this).removeClass('draggable').css('z-index', z_idx);\n                    });\n                });\n                e.preventDefault(); // disable selection\n            }).on(\"mouseup\", function() {\n                $(this).removeClass('active-handle').parent().removeClass('draggable');\n            });\n        }\n\n        $('#dialogBox .header button').click(function() { \n            // Bind close button to hide dialog\n\n            $.Dialog.hide();\n            return false;\n        });\n\n        var buttons = $('#dialogBox .action button'),\n            i = 0;\n\n        $.each(params.buttons,function(name,obj){\n            buttons.eq(i++).click(function(){\n                // Calling function and hide the dialog   \n\n                obj.action();\n                $.Dialog.hide();\n                return false;\n            });\n        });\n    }\n\n    $.Dialog.hide = function(){\n        $('#dialogOverlay').fadeOut(function(){\n            $.DialogOpened = false;\n            $(this).remove();\n        });\n    }\n})(jQuery);\n"]],"start1":0,"start2":0,"length1":0,"length2":6053}]],"length":6053}
